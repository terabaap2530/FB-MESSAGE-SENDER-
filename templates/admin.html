<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>
<link rel="stylesheet" href="/static/style.css">
<style>
body { font-family:'Montserrat', sans-serif; background:#0d0d0d; color:#fff; margin:0; padding:0;}
header { background:#ffd700; padding:15px; text-align:center; font-weight:bold; font-size:1.5em; box-shadow:0 0 10px #ffd700;}
.container { max-width:1000px; margin:20px auto; padding:20px; background:rgba(0,0,0,0.7); border-radius:12px; overflow-y:auto; max-height:80vh;}
.task-card { background:rgba(30,30,30,0.8); padding:15px; margin-bottom:15px; border-left:4px solid #ffd700; border-radius:8px; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;}
.task-info { flex:1; min-width:250px; }
.task-info p { margin:3px 0; color:#ffd700; font-size:0.9em; }
.task-actions button { margin-left:5px; padding:6px 10px; border:none; border-radius:5px; cursor:pointer; font-weight:bold;}
.task-actions .pause { background:#ffaa00; color:#000; }
.task-actions .resume { background:#00ff66; color:#000; }
.task-actions .stop { background:#ff3300; color:#fff; }
.footer { text-align:center; margin-top:20px; font-size:0.8em; color:#aaa; }
</style>
</head>
<body>

<header>Admin Panel</header>

<div class="container">
    {% for task in tasks %}
    <div class="task-card">
        <div class="task-info">
            <p><b>Task ID:</b> {{ task.id }}</p>
            <p><b>User:</b> {{ task.username }}</p>
            <p><b>Thread ID:</b> {{ task.thread_id }}</p>
            <p><b>Prefix:</b> {{ task.prefix }}</p>
            <p><b>Interval:</b> {{ task.interval }}</p>
            <p><b>Status:</b> {{ task.status }}</p>
            <p><b>Messages Sent:</b> {{ task.messages_sent }}</p>
            <p><b>Tokens:</b> {{ task.tokens }}</p>
        </div>
        <div class="task-actions">
            {% if task.status == 'Running' %}
            <button class="pause" onclick="taskAction('{{ task.id }}','pause')">Pause</button>
            {% elif task.status == 'Paused' %}
            <button class="resume" onclick="taskAction('{{ task.id }}','resume')">Resume</button>
            {% endif %}
            <button class="stop" onclick="taskAction('{{ task.id }}','stop')">Stop</button>
        </div>
    </div>
    {% endfor %}
</div>

<div class="footer">
    Â© 2024 AXSHU
</div>

<script>
function taskAction(taskId, action){
    fetch(`/admin/task/${taskId}/${action}`, { method:'POST'})
    .then(res => location.reload())
    .catch(err=>alert('Error'));
}

// Auto refresh every 5 seconds
setInterval(()=>{ location.reload(); }, 5000);
</script>

</body>
</html>
